<html>
<head>
<title>Varnish web accelerator: the right tool for the job?</title>
<style type="text/css">
body{
        font-size:13px;
        font-family:"Lucida Grande", Arial, sans-serif;
        color:#6d6d6d;
        margin-left: 10;
}
a, a:visited{
        font-family:"Lucida Grande", Arial, sans-serif; color:#6d6d6d;
}
.accToggler{
        margin: 2px;
        margin-left: 35px;
        padding: 3px;
        width: 130px;
        background: #acc95f;
        color: #f4f4f4;
        border: 1px solid #fff;
        cursor: pointer;
}
.accContent{
        margin: 3px;
        margin-left: 45px;
        width: 130px;
}
</style>

</head>
<body>


<h2>Varnish web accelerator: the right tool for the job?</h2>
<p style="margin:15px; width:95%;">Phil Cryer<br />
Submitted to Techrepublic 11/07/2007</p>
<hr>

<strong>The Job</strong> 
<p style="margin:15px; width:95%;">A client's new 'enterprise' content management system proves to be far too slow to serve the multiple dynamic web sites that it's scheduled to handle, and a reverse proxy was recommended by the company that sells the CMS to remedy the issue.</p>
<br />
<strong>The Tool</strong> 
<p style="margin:15px; width:95%;"><a href="http://varnish.projects.linpro.no/" title="Varnish">Varnish</a> is an Open Source, state-of-the-art, high-performance HTTP accelerator. Varnish is targeted primarily at the FreeBSD 6+ and Linux 2.6 platforms, and will take full advantage of the virtual memory system and advanced I/O features offered by these operating systems. Unlike other reverse proxy solutions such as Squid, Varnish was written from the ground up to be a high performance caching reverse proxy, and has been praised for its speed, stability under load and use of system resources when compared to other solutions. At the client's site we have setup Varnish, as well as Squid as reverse proxy solutions, both pointing to the same backend CMS, which in turn talks to an Oracle database. After many stress tests, the pattern remained the same. Typical results can be seen in the following graph which shows the results of stress test of 2500 requests with 40 concurrent users. The first column shows the CMS on its own for a base reading, then with Squid as a reverse proxy, and finally and with Varnish. 
</p>
<p align="center"><img src="http://phil.cryer.us/articles/images/varnish-graph.gif" alt="http://phil.cryer.us/articles/images/image006.gif" /></p>
<p>
After testing Varnish against other solutions for over a month, the following strengths and weaknesses have been observed: 
</p>
<strong>Pros</strong> 
<ul>
	<li><div>Proven to be many times faster than other current offerings 
				</div> </li> 
				<li><div> Designed with current methodologies taking full advantage of features of the latest hardware and kernel software </div> </li> 
				<li> <div> Uses far less system resources, which cuts down on hardware need and costs </div> </li> 
				<li> <div> Is Open Source and actively developed </div> </li>
				<li> <div> Is fast, fast, fast </div> </li> </ul> 
			<strong>Cons</strong> 
			<ul> <li> <div> Not as widely depoloyed or tested when compared to other offerings like Squid </div> </li> 
			<li> <div> The requirement of a C compiler on an enterprise production box may raise some eyebrows (check their FAQ for reasoning on this - and a proposed solution I've come up with) </div> </li> </ul> 
			<br /> 
			
		<strong>The Right Tool For The Job?</strong> <p style="margin:15px; width:95%;">The noise about Varnish is justified, it utilizes new programming methodologies, exploits the latest hardware and advanced features of the Linux and FreeBSD kernels in order to dramatically speed up performance of web sites. When utilized to serve dynamic web sites it will do this while actually requiring less hardware; it is that good. Its ease of use, stability under load and simple configuration make it a no brainier for anyone running a website. Varnish is the right tool for the job.</p>
<p style="margin:15px; width:95%;">Read Phil's (Varnish served) blog, <a href="http://fak3r.com/" title="fak3r.com">fak3r.com</a> for his proposed solution to rid Varnish of the C compiler requirement in order to make it a more attractive option for the enterprise sector.</p> 

</body>
</html>
